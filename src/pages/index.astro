---
import "../styles/global.css";
import Nav from "../components/nav.astro";
---

<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Donald Luxury</title>
  </head>
  <body class="bg-white text-gray-900 font-sans antialiased">

    <Nav/>

 
<!-- Preloader -->
<div id="preloader" class="fixed inset-0 flex flex-col justify-center items-center z-[9999] bg-white">
  <h1 id="preloader-h1" class="text-4xl md:text-6xl font-serif text-gray-900 tracking-wide animate-pulse animate-fade-in">
    Donald
  </h1>
  <div id="preloader-words" class="flex space-x-4 text-lg md:text-2xl text-gray-500 mt-2 animate-fade-in">
    <span class="word">Élégance</span>
    <span class="word">Discipline</span>
    <span class="word">Luxe</span>
  </div>
</div>

<!-- Main hero section -->
<section id="index-content" class="w-screen h-screen relative overflow-hidden opacity-0">
  <!-- Remove H1 here; preloader H1 will become this -->
  <div class="flex flex-col md:flex-row h-full">
    <div class="image-container relative md:w-1/3 w-full h-1/3 md:h-full overflow-hidden opacity-0">
      <img src="/images/elegance.png" class="w-full h-full object-cover brightness-50 transition duration-700" />
    </div>
    <div class="image-container relative md:w-1/3 w-full h-1/3 md:h-full overflow-hidden opacity-0">
      <img src="/images/discipline.png" class="w-full h-full object-cover brightness-50 transition duration-700" />
    </div>
    <div class="image-container relative md:w-1/3 w-full h-1/3 md:h-full overflow-hidden opacity-0">
      <img src="/images/luxury.png" class="w-full h-full object-cover brightness-50 transition duration-700" />
    </div>
  </div>
</section>

<script type="module">
window.addEventListener('load', () => {
  const preloader = document.getElementById('preloader');
  const h1 = document.getElementById('preloader-h1');
  const words = document.querySelectorAll('#preloader-words .word');
  const images = document.querySelectorAll('.image-container');
  const mainSection = document.getElementById('index-content');

  // Show main content underneath preloader
  mainSection.classList.remove('opacity-0');

  // Step 1: Fade out preloader background but keep text visible
  setTimeout(() => {
    preloader.style.backgroundColor = 'transparent';
    preloader.style.transition = 'background-color 1s ease';
  }, 1200);

  // Step 2: Animate words flying and fade in images
  setTimeout(() => {
    words.forEach((word, i) => {
      const imgRect = images[i].getBoundingClientRect();
      const startRect = word.getBoundingClientRect();

      word.style.position = 'fixed';
      word.style.left = `${startRect.left}px`;
      word.style.top = `${startRect.top}px`;
      word.style.transition = 'all 1.2s ease';
      word.style.zIndex = 50;
      word.getBoundingClientRect();

      word.style.left = `${imgRect.left + imgRect.width / 2}px`;
      word.style.top = `${imgRect.top + imgRect.height - 30}px`;
      word.style.transform = 'translateX(-50%)';

        // Change color to white as it reaches the dark image
  word.style.color = 'white';
  
      setTimeout(() => {
        word.style.position = 'absolute';
        word.style.left = '50%';
        word.style.top = 'calc(100% - 30px)';
        word.style.transform = 'translateX(-50%)';
        images[i].appendChild(word);
      }, 1200);
    });

    images.forEach(img => {
      img.style.transition = 'opacity 1.2s ease';
      img.style.opacity = '1';
    });
  }, 1400);


  // Step 3: Animate preloader H1 into hero position and change color
const heroX = window.innerWidth / 2;
const heroY = window.innerHeight / 2;
setTimeout(() => {
  const h1Rect = h1.getBoundingClientRect();

  // Move H1 to fixed so we can animate
  h1.style.position = 'fixed';
  h1.style.left = `${h1Rect.left}px`;
  h1.style.top = `${h1Rect.top}px`;
  h1.style.transition = 'all 1.2s ease, color 1.2s ease';
  h1.style.zIndex = 50;
  h1.getBoundingClientRect();

  // Animate to hero position
  h1.style.left = `${heroX}px`;
  h1.style.top = `${heroY}px`;
  h1.style.transform = 'translate(-50%, -50%)';
  h1.style.color = 'white';

  // After animation, move H1 into the hero section permanently
  setTimeout(() => {
    h1.style.position = 'absolute';
    h1.style.left = '50%';
    h1.style.top = '50%';
    h1.style.transform = 'translate(-50%, -50%)';
    h1.style.zIndex = 20;
    document.getElementById('index-content').prepend(h1); // move into main section
  }, 1200);

}, 1400);

// Step 4: Remove only the preloader background/words
setTimeout(() => {
  const words = document.querySelectorAll('#preloader-words .word');
  words.forEach(w => w.remove());
  const preloader = document.getElementById('preloader');
  preloader.style.opacity = '0';
  setTimeout(() => preloader.remove(), 1000);
}, 2600);

});
</script>
