---
import "../styles/nav.css"
---
<nav id="main-nav" class="w-full z-20 top-0 left-0 bg-black/10 sm:bg-black/20  sm:fixed stick p-3 sm:p-4 animate-fade-down transition-all duration-300 relative flex items-center justify-between">
     <div class="hidden sm:flex space-x-6">
      <a href="/" class="text-white hover:text-amber-500">Le portail</a>
      <a href="/mode" class="text-white hover:text-amber-500">Mode</a>
      <a href="/portefermée" class="text-white hover:text-amber-500">Porte Ferméet</a>
    </div>

  <!-- Mobile Hamburger - small screens only -->
  <button
    id="menu-toggle"
    class="sm:hidden flex flex-col justify-center items-center w-8 h-8 relative"
    aria-label="Toggle menu"
    aria-expanded="false"
  >
    <span id="line1" class="block absolute h-0.5 w-6 bg-white left-1 top-2 transition-transform duration-300 origin-center"></span>
    <span id="line2" class="block absolute h-0.5 w-6 bg-white left-1 top-3.5 transition-opacity duration-300"></span>
    <span id="line3" class="block absolute h-0.5 w-6 bg-white left-1 top-5 transition-transform duration-300 origin-center"></span>
  </button>

</nav>

<!-- Mobile Menu -->
<div
  id="mobile-menu"
  class="sm:hidden flex flex-col gap-4 px-4 text-white text-lg font-medium overflow-hidden transform scale-y-0 origin-top transition-transform duration-[700ms]"
>
  <a href="/" class="hover:text-blue-400 py-2">Le portail</a>
  <a href="/mode" class="hover:text-blue-400 py-2">Mode</a>
  <a href="/portefermée" class="hover:text-blue-400 py-2">Porte Fermée</a>
</div>

<style>
  /* Hamburger animation */
  body.menu-open #line1 {
    transform: rotate(45deg) translate(5px, 5px);
  }
  body.menu-open #line2 {
    opacity: 0;
  }
  body.menu-open #line3 {
    transform: rotate(-45deg) translate(5px, -5px);
  }

  /* Mobile blur only when menu is open */
@media (max-width: 639px) {
  nav {
    backdrop-filter: none;
  }

  body.menu-open nav {
    backdrop-filter: blur(8px);
    background-color: rgba(0, 0, 0, 0.5);
  }

  /* Mobile menu full dark background */
  #mobile-menu {
    background-color: rgba(0, 0, 0, 0.5); /* almost solid black */
    backdrop-filter: blur(8px); /* optional blur to match navbar */
  }
}
</style>

<script is:inline>
const menuToggle = document.getElementById("menu-toggle");
const mobileMenu = document.getElementById("mobile-menu");
const nav = document.getElementById('main-nav');

// ---- Mobile menu toggle ----
menuToggle.addEventListener("click", () => {
  const isOpen = mobileMenu.classList.toggle("scale-y-100");
  mobileMenu.classList.toggle("scale-y-0", !isOpen);
  document.body.classList.toggle("menu-open", isOpen);
  menuToggle.setAttribute("aria-expanded", isOpen);
});

// ---- Hide/Show nav on scroll ----
let lastScrollY = window.scrollY;
window.addEventListener('scroll', () => {
  const currentY = window.scrollY;

  if (currentY > lastScrollY && currentY > 80) {
    // scrolling down → hide nav
    nav.style.transform = 'translateY(-100%)';
  } else {
    // scrolling up → show nav
    nav.style.transform = 'translateY(0)';
  }

  lastScrollY = currentY;
});
</script>